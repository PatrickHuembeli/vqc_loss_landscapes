---

title: Compare Hessian, metric tensor and vanilla SGD

keywords: fastai
sidebar: home_sidebar



---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: Ex3_Hessian_vs_metric_tensor.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
<span class="kn">from</span> <span class="nn">pennylane</span> <span class="kn">import</span> <span class="n">expval</span><span class="p">,</span> <span class="n">var</span>

<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>

<span class="kn">from</span> <span class="nn">vqc_loss_landscapes.hess_vs_metrictensor</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">pennylane.utils</span> <span class="kn">import</span> <span class="n">_flatten</span><span class="p">,</span> <span class="n">unflatten</span>
<span class="kn">from</span> <span class="nn">pennylane.optimize</span> <span class="kn">import</span> <span class="n">GradientDescentOptimizer</span>

<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span> <span class="k">as</span> <span class="n">tqdm</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Draw-circuit-with-Qiskit.Aer-device">Draw circuit with Qiskit.Aer device<a class="anchor-link" href="#Draw-circuit-with-Qiskit.Aer-device"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">width</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># must be odd</span>
<span class="n">layers</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">width</span><span class="p">,))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">width</span><span class="p">))</span>
<span class="n">rho_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">target</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">init_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">width</span> <span class="o">*</span> <span class="n">layers</span> <span class="o">*</span><span class="mi">3</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Setup_For_Training</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">rho_target</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;qiskit.aer&quot;</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">init_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">qcircuit</span>

<span class="n">circuit</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">dev</span><span class="o">.</span><span class="n">_circuit</span>
<span class="n">a</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<pre style="word-wrap: normal;white-space: pre;background: #fff0;line-height: 1.1;font-family: &quot;Courier New&quot;,Courier,monospace">      ┌────────────┐┌────────────┐ ┌────────────┐   ┌───────────┐ »
q_0: ─┤ RZ(5.3773) ├┤ RY(2.2459) ├─┤ RZ(2.0572) ├─■─┤ RZ(1.934) ├─»
     ┌┴────────────┤├────────────┤┌┴────────────┤ │ ├───────────┴┐»
q_1: ┤ RZ(0.24209) ├┤ RY(0.4382) ├┤ RZ(0.55355) ├─■─┤ RZ(4.2309) ├»
     └─────────────┘└────────────┘└─────────────┘   └────────────┘»
c_0: ═════════════════════════════════════════════════════════════»
                                                                  »
c_1: ═════════════════════════════════════════════════════════════»
                                                                  »
«     ┌────────────┐┌────────────┐   ┌──────────┐┌─┐   
«q_0: ┤ RY(2.0928) ├┤ RZ(1.0993) ├─■─┤1         ├┤M├───
«     ├────────────┤├────────────┤ │ │  unitary │└╥┘┌─┐
«q_1: ┤ RY(0.5574) ├┤ RZ(3.8018) ├─■─┤0         ├─╫─┤M├
«     └────────────┘└────────────┘   └──────────┘ ║ └╥┘
«c_0: ════════════════════════════════════════════╩══╬═
«                                                    ║ 
«c_1: ═══════════════════════════════════════════════╩═
«                                                      </pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">shots</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="n">epochs</span> <span class="o">=</span> <span class="mi">100</span>

<span class="n">width</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">layers</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="o">**</span><span class="n">width</span><span class="p">,))</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">width</span><span class="p">))</span>
<span class="n">rho_target</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">target</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">conj</span><span class="p">(</span><span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Setup_For_Training</span><span class="p">(</span><span class="n">layers</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">rho_target</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s2">&quot;default.qubit&quot;</span><span class="p">)</span>

<span class="n">theta</span> <span class="o">=</span> <span class="n">init_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">qcircuit</span>

<span class="k">for</span> <span class="n">new_params</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">init_params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">width</span> <span class="o">*</span> <span class="n">layers</span><span class="o">*</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plot_lists</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">lr_list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">run</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="n">lr</span><span class="o">=</span><span class="mf">0.1</span>
        <span class="n">opt</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
        <span class="n">epochs</span><span class="o">=</span><span class="mi">100</span>
        <span class="k">if</span> <span class="n">run</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;normal SGD&quot;</span><span class="p">)</span>
            <span class="n">get_hessian</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">get_metr_tens</span><span class="o">=</span><span class="kc">False</span>
        <span class="k">if</span> <span class="n">run</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metric Tensor&quot;</span><span class="p">)</span>
            <span class="n">get_hessian</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">get_metr_tens</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">if</span> <span class="n">run</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hessian&quot;</span><span class="p">)</span>
            <span class="n">get_hessian</span><span class="o">=</span><span class="kc">True</span>
            <span class="n">get_metr_tens</span><span class="o">=</span><span class="kc">False</span>

        <span class="n">loss_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">learning_rates</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">metric_tensor_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">init_params</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">),</span> <span class="n">bar_format</span><span class="o">=</span><span class="s1">&#39;</span><span class="si">{desc}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="n">progress</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cost_fidelity</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">circuit</span><span class="p">)</span>
            <span class="n">loss_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">get_hessian</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="n">H</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">Hessian</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">circuit</span><span class="p">)</span>
                <span class="n">Hev</span><span class="p">,</span> <span class="n">Hv</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">H</span><span class="p">)</span>
                <span class="n">lr</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">Hev</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
                <span class="n">opt</span> <span class="o">=</span> <span class="n">qml</span><span class="o">.</span><span class="n">GradientDescentOptimizer</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">cost_fidelity</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">circuit</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">get_metr_tens</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">params</span><span class="p">,</span> <span class="n">tensor</span> <span class="o">=</span> <span class="n">step</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> 
                                      <span class="n">circuit</span><span class="o">.</span><span class="n">metric_tensor</span><span class="p">([</span><span class="n">params</span><span class="p">],</span> <span class="n">diag_approx</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span> 
                                      <span class="n">opt</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">circuit</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.00000001</span><span class="p">)</span>
                <span class="n">metric_tensor_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params</span> <span class="o">=</span> <span class="n">opt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="k">lambda</span> <span class="n">v</span><span class="p">:</span> <span class="n">model</span><span class="o">.</span><span class="n">cost_fidelity</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">circuit</span><span class="p">),</span> <span class="n">params</span><span class="p">)</span>
            
            <span class="n">progress</span><span class="o">.</span><span class="n">set_description_str</span><span class="p">(</span><span class="s1">&#39;loss: </span><span class="si">{:3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">loss</span><span class="p">))</span>
            <span class="n">learning_rates</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lr</span><span class="p">)</span>
        <span class="n">plot_lists</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss_list</span><span class="p">)</span>
        <span class="n">lr_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">learning_rates</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">loss_list</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">plot</span> <span class="ow">in</span> <span class="n">plot_lists</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plot</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>normal SGD

</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Metric Tensor

</pre>
</div>
</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
"
>
</div>

</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Hessian
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">KeyboardInterrupt</span>                         Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-53b175c0fa3d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">     44</span>             loss_list<span class="ansi-blue-fg">.</span>append<span class="ansi-blue-fg">(</span>loss<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>             <span class="ansi-green-fg">if</span> get_hessian<span class="ansi-blue-fg">==</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 46</span><span class="ansi-red-fg">                 </span>H <span class="ansi-blue-fg">=</span> model<span class="ansi-blue-fg">.</span>Hessian<span class="ansi-blue-fg">(</span>params<span class="ansi-blue-fg">,</span> circuit<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>                 Hev<span class="ansi-blue-fg">,</span> Hv <span class="ansi-blue-fg">=</span> np<span class="ansi-blue-fg">.</span>linalg<span class="ansi-blue-fg">.</span>eigh<span class="ansi-blue-fg">(</span>H<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     48</span>                 lr <span class="ansi-blue-fg">=</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">/</span>Hev<span class="ansi-blue-fg">.</span>max<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/Dropbox/34_5_vqc_loss_landscapes/vqc_loss_landscapes/hess_vs_metrictensor.py</span> in <span class="ansi-cyan-fg">Hessian</span><span class="ansi-blue-fg">(self, params, circuit)</span>
<span class="ansi-green-intense-fg ansi-bold">    132</span>                     measure_pm <span class="ansi-blue-fg">=</span> circuit<span class="ansi-blue-fg">(</span>eps_pm<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    133</span>                     measure_mp <span class="ansi-blue-fg">=</span> circuit<span class="ansi-blue-fg">(</span>eps_mp<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">--&gt; 134</span><span class="ansi-red-fg">                     </span>measure_mm <span class="ansi-blue-fg">=</span> circuit<span class="ansi-blue-fg">(</span>eps_mm<span class="ansi-blue-fg">.</span>reshape<span class="ansi-blue-fg">(</span>shape<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    135</span>                     <span class="ansi-red-fg">#result_eps_pp = torch.tensor([exp_value_pp])</span>
<span class="ansi-green-intense-fg ansi-bold">    136</span>                     <span class="ansi-red-fg">#print(measure_mm, measure_mp)</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/pennylane/interfaces/autograd.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     45</span>             <span class="ansi-red-fg"># prevents autograd boxed arguments from going through to evaluate</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>             args <span class="ansi-blue-fg">=</span> autograd<span class="ansi-blue-fg">.</span>builtins<span class="ansi-blue-fg">.</span>tuple<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">)</span>  <span class="ansi-red-fg"># pylint: disable=no-member</span>
<span class="ansi-green-fg">---&gt; 47</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>evaluate<span class="ansi-blue-fg">(</span>args<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     48</span> 
<span class="ansi-green-intense-fg ansi-bold">     49</span>         <span class="ansi-blue-fg">@</span>staticmethod

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/autograd/tracer.py</span> in <span class="ansi-cyan-fg">f_wrapped</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     46</span>             <span class="ansi-green-fg">return</span> new_box<span class="ansi-blue-fg">(</span>ans<span class="ansi-blue-fg">,</span> trace<span class="ansi-blue-fg">,</span> node<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     47</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">---&gt; 48</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> f_raw<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     49</span>     f_wrapped<span class="ansi-blue-fg">.</span>fun <span class="ansi-blue-fg">=</span> f_raw
<span class="ansi-green-intense-fg ansi-bold">     50</span>     f_wrapped<span class="ansi-blue-fg">.</span>_is_autograd_primitive <span class="ansi-blue-fg">=</span> <span class="ansi-green-fg">True</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/pennylane/qnodes/base.py</span> in <span class="ansi-cyan-fg">evaluate</span><span class="ansi-blue-fg">(self, args, kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    771</span>         <span class="ansi-green-fg">if</span> isinstance<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">,</span> qml<span class="ansi-blue-fg">.</span>QubitDevice<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    772</span>             <span class="ansi-red-fg"># TODO: remove this if statement once all devices are ported to the QubitDevice API</span>
<span class="ansi-green-fg">--&gt; 773</span><span class="ansi-red-fg">             </span>ret <span class="ansi-blue-fg">=</span> self<span class="ansi-blue-fg">.</span>device<span class="ansi-blue-fg">.</span>execute<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>circuit<span class="ansi-blue-fg">,</span> return_native_type<span class="ansi-blue-fg">=</span>temp<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    774</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    775</span>             ret = self.device.execute(

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/pennylane/_qubit_device.py</span> in <span class="ansi-cyan-fg">execute</span><span class="ansi-blue-fg">(self, circuit, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    149</span>         self<span class="ansi-blue-fg">.</span>check_validity<span class="ansi-blue-fg">(</span>circuit<span class="ansi-blue-fg">.</span>operations<span class="ansi-blue-fg">,</span> circuit<span class="ansi-blue-fg">.</span>observables<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    150</span> 
<span class="ansi-green-fg">--&gt; 151</span><span class="ansi-red-fg">         </span>self<span class="ansi-blue-fg">.</span>_circuit_hash <span class="ansi-blue-fg">=</span> circuit<span class="ansi-blue-fg">.</span>hash
<span class="ansi-green-intense-fg ansi-bold">    152</span> 
<span class="ansi-green-intense-fg ansi-bold">    153</span>         <span class="ansi-red-fg"># apply all circuit operations</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/pennylane/circuit_graph.py</span> in <span class="ansi-cyan-fg">hash</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    220</span>             int<span class="ansi-blue-fg">:</span> the hash of the serialized quantum circuit graph
<span class="ansi-green-intense-fg ansi-bold">    221</span>         &#34;&#34;&#34;
<span class="ansi-green-fg">--&gt; 222</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">return</span> hash<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>serialize<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    223</span> 
<span class="ansi-green-intense-fg ansi-bold">    224</span>     <span class="ansi-blue-fg">@</span>property

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/pennylane/circuit_graph.py</span> in <span class="ansi-cyan-fg">serialize</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    206</span>             <span class="ansi-green-fg">for</span> param <span class="ansi-green-fg">in</span> obs<span class="ansi-blue-fg">.</span>params<span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    207</span>                 serialization_string <span class="ansi-blue-fg">+=</span> delimiter
<span class="ansi-green-fg">--&gt; 208</span><span class="ansi-red-fg">                 </span>serialization_string <span class="ansi-blue-fg">+=</span> str<span class="ansi-blue-fg">(</span>param<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    209</span>                 serialization_string <span class="ansi-blue-fg">+=</span> delimiter
<span class="ansi-green-intense-fg ansi-bold">    210</span> 

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">_array_str_implementation</span><span class="ansi-blue-fg">(a, max_line_width, precision, suppress_small, array2string)</span>
<span class="ansi-green-intense-fg ansi-bold">   1504</span>         <span class="ansi-green-fg">return</span> _guarded_repr_or_str<span class="ansi-blue-fg">(</span>np<span class="ansi-blue-fg">.</span>ndarray<span class="ansi-blue-fg">.</span>__getitem__<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1505</span> 
<span class="ansi-green-fg">-&gt; 1506</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> array2string<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> max_line_width<span class="ansi-blue-fg">,</span> precision<span class="ansi-blue-fg">,</span> suppress_small<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#39; &#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">&#34;&#34;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">   1507</span> 
<span class="ansi-green-intense-fg ansi-bold">   1508</span> 

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">array2string</span><span class="ansi-blue-fg">(a, max_line_width, precision, suppress_small, separator, prefix, style, formatter, threshold, edgeitems, sign, floatmode, suffix, **kwarg)</span>
<span class="ansi-green-intense-fg ansi-bold">    710</span>         <span class="ansi-green-fg">return</span> <span class="ansi-blue-fg">&#34;[]&#34;</span>
<span class="ansi-green-intense-fg ansi-bold">    711</span> 
<span class="ansi-green-fg">--&gt; 712</span><span class="ansi-red-fg">     </span><span class="ansi-green-fg">return</span> _array2string<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">,</span> options<span class="ansi-blue-fg">,</span> separator<span class="ansi-blue-fg">,</span> prefix<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    713</span> 
<span class="ansi-green-intense-fg ansi-bold">    714</span> 

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(self, *args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">    482</span>             repr_running<span class="ansi-blue-fg">.</span>add<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    483</span>             <span class="ansi-green-fg">try</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 484</span><span class="ansi-red-fg">                 </span><span class="ansi-green-fg">return</span> f<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    485</span>             <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    486</span>                 repr_running<span class="ansi-blue-fg">.</span>discard<span class="ansi-blue-fg">(</span>key<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">_array2string</span><span class="ansi-blue-fg">(a, options, separator, prefix)</span>
<span class="ansi-green-intense-fg ansi-bold">    517</span>     lst = _formatArray(a, format_function, options[&#39;linewidth&#39;],
<span class="ansi-green-intense-fg ansi-bold">    518</span>                        next_line_prefix<span class="ansi-blue-fg">,</span> separator<span class="ansi-blue-fg">,</span> options<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;edgeitems&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 519</span><span class="ansi-red-fg">                        summary_insert, options[&#39;legacy&#39;])
</span><span class="ansi-green-intense-fg ansi-bold">    520</span>     <span class="ansi-green-fg">return</span> lst
<span class="ansi-green-intense-fg ansi-bold">    521</span> 

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">_formatArray</span><span class="ansi-blue-fg">(a, format_function, line_width, next_line_prefix, separator, edge_items, summary_insert, legacy)</span>
<span class="ansi-green-intense-fg ansi-bold">    838</span>         return recurser(index=(),
<span class="ansi-green-intense-fg ansi-bold">    839</span>                         hanging_indent<span class="ansi-blue-fg">=</span>next_line_prefix<span class="ansi-blue-fg">,</span>
<span class="ansi-green-fg">--&gt; 840</span><span class="ansi-red-fg">                         curr_width=line_width)
</span><span class="ansi-green-intense-fg ansi-bold">    841</span>     <span class="ansi-green-fg">finally</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    842</span>         <span class="ansi-red-fg"># recursive closures have a cyclic reference to themselves, which</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">recurser</span><span class="ansi-blue-fg">(index, hanging_indent, curr_width)</span>
<span class="ansi-green-intense-fg ansi-bold">    824</span>             <span class="ansi-green-fg">for</span> i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>trailing_items<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    825</span>                 nested = recurser(index + (-i,), next_hanging_indent,
<span class="ansi-green-fg">--&gt; 826</span><span class="ansi-red-fg">                                   next_width)
</span><span class="ansi-green-intense-fg ansi-bold">    827</span>                 s <span class="ansi-blue-fg">+=</span> hanging_indent <span class="ansi-blue-fg">+</span> nested <span class="ansi-blue-fg">+</span> line_sep
<span class="ansi-green-intense-fg ansi-bold">    828</span> 

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">recurser</span><span class="ansi-blue-fg">(index, hanging_indent, curr_width)</span>
<span class="ansi-green-intense-fg ansi-bold">    792</span> 
<span class="ansi-green-intense-fg ansi-bold">    793</span>             <span class="ansi-green-fg">for</span> i <span class="ansi-green-fg">in</span> range<span class="ansi-blue-fg">(</span>trailing_items<span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">1</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 794</span><span class="ansi-red-fg">                 </span>word <span class="ansi-blue-fg">=</span> recurser<span class="ansi-blue-fg">(</span>index <span class="ansi-blue-fg">+</span> <span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span>i<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">,</span> next_hanging_indent<span class="ansi-blue-fg">,</span> next_width<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    795</span>                 s, line = _extendLine(
<span class="ansi-green-intense-fg ansi-bold">    796</span>                     s, line, word, elem_width, hanging_indent, legacy)

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">recurser</span><span class="ansi-blue-fg">(index, hanging_indent, curr_width)</span>
<span class="ansi-green-intense-fg ansi-bold">    746</span> 
<span class="ansi-green-intense-fg ansi-bold">    747</span>         <span class="ansi-green-fg">if</span> axes_left <span class="ansi-blue-fg">==</span> <span class="ansi-cyan-fg">0</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 748</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> format_function<span class="ansi-blue-fg">(</span>a<span class="ansi-blue-fg">[</span>index<span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    749</span> 
<span class="ansi-green-intense-fg ansi-bold">    750</span>         <span class="ansi-red-fg"># when recursing, add a space to align with the [ added, and reduce the</span>

<span class="ansi-green-fg">~/anaconda3/envs/QC/lib/python3.7/site-packages/numpy/core/arrayprint.py</span> in <span class="ansi-cyan-fg">__call__</span><span class="ansi-blue-fg">(self, x)</span>
<span class="ansi-green-intense-fg ansi-bold">    966</span> 
<span class="ansi-green-intense-fg ansi-bold">    967</span>     <span class="ansi-green-fg">def</span> __call__<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">,</span> x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 968</span><span class="ansi-red-fg">         </span><span class="ansi-green-fg">if</span> <span class="ansi-green-fg">not</span> np<span class="ansi-blue-fg">.</span>isfinite<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    969</span>             <span class="ansi-green-fg">with</span> errstate<span class="ansi-blue-fg">(</span>invalid<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;ignore&#39;</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">    970</span>                 <span class="ansi-green-fg">if</span> np<span class="ansi-blue-fg">.</span>isnan<span class="ansi-blue-fg">(</span>x<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>

<span class="ansi-red-fg">KeyboardInterrupt</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

